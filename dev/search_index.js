var documenterSearchIndex = {"docs":
[{"location":"#","page":"Yama 山","title":"Yama 山","text":"CurrentModule = Yama","category":"page"},{"location":"#Yama-山-1","page":"Yama 山","title":"Yama 山","text":"","category":"section"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"Visualize loss landscape.","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"<p align=\"center\">\n  <img src=\"../../res/mnist.png\" width=250>\n  <img src=\"../../res/mnist-log.png\" width=250>\n  <img src=\"../../res/custom.png\" width=250>\n</p>","category":"page"},{"location":"#MNIST-Example-1","page":"Yama 山","title":"MNIST Example","text":"","category":"section"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"Import necessary stuff.","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"using Flux.Data.MNIST: images, labels\nusing Yama: create_surface, SurfaceArgs\nusing Plots\n\npyplot()\nPlots.PyPlotBackend()","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"Define parameters used when creating surface.","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"args = SurfaceArgs(\n    model_file=\"./mpl-mnist.bson\",\n    save_file=\"./surface.bson\",\n)","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"Create and load model if specified model_file in SurfaceArgs.","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"model = Chain(Dense(28 * 28, 10))\nif !isa(args.model_file, Nothing)\n    @load args.model_file model_parameters\n    loadparams!(model, model_parameters)\nend","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"Define function that computes loss on mini-batch. Note that if you set use_gpu in SurfaceArgs to true, then it is up to you to transfer mini-batch to gpu as done in this example.","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"function make_minibatch(data, labels)\n    batch_size = length(data)\n    batch = Array{Float32}(undef, size(data[1])..., 1, batch_size)\n    @inbounds for i in 1:batch_size\n        batch[:, :, :, i] = Float32.(data[i])\n    end\n\n    batch, Float32.(onehotbatch(labels, 0:9))\nend\n\nfunction evaluation_step(model, batch, args::SurfaceArgs)\n    x, y = make_minibatch(batch...)\n    x = flatten(x)\n    if args.use_gpu\n        x = x |> gpu\n        y = y |> gpu\n    end\n    logitcrossentropy(model(x), y)\nend","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"Compute, save and plot loss surface.","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"coordinates, loss_surface = create_surface(\n    model, loader, evaluation_step, args,\n)\nif !isa(args.save_file, Nothing)\n    @save args.save_file coordinates loss_surface\nend\n\nsurface(coordinates..., loss_surface, linewidth=0, antialiased=false)\ngui()","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"You can later load already computed surface, without the need to re-compute from scratch.","category":"page"},{"location":"#","page":"Yama 山","title":"Yama 山","text":"@load args.save_file coordinates loss_surface","category":"page"},{"location":"docs/#User-API-1","page":"User API","title":"User API","text":"","category":"section"},{"location":"docs/#","page":"User API","title":"User API","text":"Modules = [Yama]\nPrivate = false","category":"page"},{"location":"docs/#Yama.create_surface-Tuple{Any,Flux.Data.DataLoader,Any,SurfaceArgs}","page":"User API","title":"Yama.create_surface","text":"function create_surface(\n    model, dataloader::DataLoader, evaluation_step, args::SurfaceArgs,\n)\n\nCreate loss surface.\n\nParameters\n\nmodel: Model to use in loss function.\ndataloader::DataLoader: Dataset on which to evaluate loss function.\nevaluation_step:   Custom-defined function which given model, mini-batch and args,   computes loss on that mini-batch.\nargs::SurfaceArgs: Parameters used when computing surface.\n\nnote: Note\nIf you specified use_gpu in args, then it is up to you, to transfer mini-batch in evaluation_step function to gpu.\n\n\n\n\n\n","category":"method"}]
}
